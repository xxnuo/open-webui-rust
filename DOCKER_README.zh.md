# Docker è®¾ç½®æ–‡æ¡£

Open WebUI å®Œæ•´çš„ Docker è®¾ç½®ï¼ŒåŒ…å« Rust åç«¯ã€PostgreSQLã€Redisã€Socket.IO å’Œå‰ç«¯ã€‚

## æ–‡æ¡£ç´¢å¼•

é€‰æ‹©é€‚åˆæ‚¨éœ€æ±‚çš„æŒ‡å—ï¼š

### [å¿«é€Ÿå…¥é—¨æŒ‡å—](DOCKER_QUICKSTART.zh.md)
**é€‚åˆæƒ³è¦å¿«é€Ÿè¿è¡Œåº”ç”¨çš„ç”¨æˆ·**
- 3åˆ†é’Ÿå¿«é€Ÿå¼€å§‹
- åŸºæœ¬å‘½ä»¤å’Œæ•…éšœæ’é™¤
- å¸¸ç”¨æ“ä½œ
- ç”Ÿäº§éƒ¨ç½²åŸºç¡€

### [å¼€å‘æŒ‡å—](DOCKER_DEV.zh.md)
**é€‚åˆæ­£åœ¨å¼€å‘ä»£ç çš„å¼€å‘è€…**
- æœ¬åœ°å¼€å‘è®¾ç½®
- åœ¨ Docker ä¸­è¿è¡ŒæœåŠ¡çš„åŒæ—¶è¿›è¡Œæœ¬åœ°å¼€å‘
- è°ƒè¯•æŠ€å·§
- æ•°æ®åº“ç®¡ç†
- æ€§èƒ½ä¼˜åŒ–

### [å®Œæ•´è®¾ç½®æŒ‡å—](DOCKER_SETUP.zh.md)
**é€‚åˆéœ€è¦è¯¦ç»†ä¿¡æ¯å’Œé«˜çº§ç”¨æ³•**
- æ¶æ„è¯´æ˜
- æœåŠ¡è¯¦æƒ…
- å·ç®¡ç†
- å¤‡ä»½å’Œæ¢å¤ç¨‹åº
- ç”Ÿäº§éƒ¨ç½²
- å…¨é¢æ•…éšœæ’é™¤

## æ¶æ„æ¦‚è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Docker Compose æ ˆ                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  å‰ç«¯       â”‚  â”‚  Socket.IO   â”‚  â”‚  Rust åç«¯      â”‚ â”‚
â”‚  â”‚  (SvelteKit)â”‚â”€â”€â”‚  æ¡¥æ¥        â”‚â”€â”€â”‚  (Actix-web)    â”‚ â”‚
â”‚  â”‚  ç«¯å£ 3000  â”‚  â”‚  ç«¯å£ 8081   â”‚  â”‚  ç«¯å£ 8080      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚         â”‚                â”‚                   â”‚           â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                          â”‚                               â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚         â”‚                                 â”‚              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚  PostgreSQL  â”‚              â”‚      Redis        â”‚     â”‚
â”‚  â”‚  ç«¯å£ 5432   â”‚              â”‚    ç«¯å£ 6379      â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## å¿«é€Ÿå‘½ä»¤

### é¦–æ¬¡è®¾ç½®
```bash
# 1. è®¾ç½®ç¯å¢ƒ
./docker-manage.sh setup

# 2. å¯åŠ¨æ‰€æœ‰æœåŠ¡
./docker-manage.sh start

# 3. è®¿é—®åº”ç”¨
open http://localhost:3000
```

### æ—¥å¸¸å¼€å‘
```bash
# å¯åŠ¨
./docker-manage.sh start

# æŸ¥çœ‹æ—¥å¿—
./docker-manage.sh logs

# æ›´æ”¹åé‡å¯
./docker-manage.sh restart rust-backend

# åœæ­¢
./docker-manage.sh stop
```

### ç»´æŠ¤
```bash
# æ£€æŸ¥å¥åº·çŠ¶æ€
./docker-manage.sh health

# å¤‡ä»½
./docker-manage.sh backup

# æŸ¥çœ‹çŠ¶æ€
./docker-manage.sh status
```

## åŒ…å«çš„å†…å®¹

### ç”Ÿäº§æ ˆ (`docker-compose.yaml`)
- **PostgreSQL 16** - ä¸»æ•°æ®åº“
- **Redis 7** - ç¼“å­˜å’Œä¼šè¯ç®¡ç†
- **Rust åç«¯** - API æœåŠ¡å™¨ (Actix-web)
- **Socket.IO æ¡¥æ¥** - å®æ—¶ WebSocket æ”¯æŒ (Python)
- **å‰ç«¯** - SvelteKit UI ä¸ Python åç«¯

### å¼€å‘æ ˆ (`docker-compose.dev.yaml`)
- PostgreSQLã€Redisã€Socket.IO æ¡¥æ¥
- **pgAdmin** - æ•°æ®åº“ç®¡ç† UI
- **Redis Commander** - Redis ç®¡ç† UI
- ä¼˜åŒ–ç”¨äº Rust åç«¯å’Œå‰ç«¯åœ¨ Docker å¤–è¿è¡Œçš„æœ¬åœ°å¼€å‘

## å…³é”®ç‰¹æ€§

### âœ… æ•°æ®åº“è¿ç§»
- å¯åŠ¨æ—¶è‡ªåŠ¨è¿ç§»
- è¿ç§»è„šæœ¬ä½äº `rust-backend/migrations/postgres/`
- åŸºäº SQLx çš„è¿ç§»ç³»ç»Ÿ

### âœ… æ•°æ®æŒä¹…åŒ–
- æ‰€æœ‰æ•°æ®å­˜å‚¨åœ¨ Docker å·ä¸­
- è½»æ¾å¤‡ä»½å’Œæ¢å¤
- ç‹¬ç«‹çš„å¼€å‘å’Œç”Ÿäº§å·

### âœ… å¥åº·æ£€æŸ¥
- æ‰€æœ‰æœåŠ¡éƒ½æœ‰å¥åº·æ£€æŸ¥
- æ­£ç¡®çš„å¯åŠ¨é¡ºåº
- è‡ªåŠ¨ç®¡ç†ä¾èµ–å…³ç³»

### âœ… å®æ—¶ç‰¹æ€§
- Socket.IO ç”¨äº WebSocket æ”¯æŒ
- Redis æ”¯æŒå¯æ‰©å±•æ€§
- é¢‘é“å’ŒèŠå¤©äº‹ä»¶

### âœ… å¼€å‘å·¥å…·
- pgAdmin ç”¨äºæ•°æ®åº“æ£€æŸ¥
- Redis Commander ç”¨äºç¼“å­˜æ£€æŸ¥
- çƒ­é‡è½½æ”¯æŒ
- è¯¦ç»†æ—¥å¿—è®°å½•

## è¦æ±‚

- Docker 24.0+
- Docker Compose 2.0+
- æœ€å°‘ 4GB å†…å­˜
- 10GB å¯ç”¨ç£ç›˜ç©ºé—´

## é»˜è®¤ç«¯å£

| æœåŠ¡ | ç«¯å£ | URL |
|---------|------|-----|
| å‰ç«¯ | 3000 | http://localhost:3000 |
| Rust åç«¯ | 8080 | http://localhost:8080 |
| Socket.IO | 8081 | http://localhost:8081 |
| PostgreSQL | 5432 | localhost:5432 |
| Redis | 6379 | localhost:6379 |
| pgAdmin | 5050 | http://localhost:5050 |
| Redis Commander | 8082 | http://localhost:8082 |

æ‰€æœ‰ç«¯å£éƒ½å¯é€šè¿‡ `.env` æ–‡ä»¶é…ç½®ã€‚

## å®‰å…¨æ³¨æ„äº‹é¡¹

### å¼€å‘ç¯å¢ƒï¼ˆé»˜è®¤ï¼‰
- `env.example` ä¸­ä½¿ç”¨ç®€å•å¯†ç 
- å¼€æ”¾çš„ CORS ç­–ç•¥
- æ‰€æœ‰åŠŸèƒ½å·²å¯ç”¨
- âš ï¸ **ä¸é€‚åˆç”Ÿäº§ä½¿ç”¨**

### ç”Ÿäº§ç¯å¢ƒ
å¿…éœ€çš„æ›´æ”¹ï¼š
1. ç”Ÿæˆå¼º `WEBUI_SECRET_KEY`
2. æ›´æ”¹ `POSTGRES_PASSWORD`
3. æ­£ç¡®é…ç½® CORS
4. ä½¿ç”¨ HTTPSï¼ˆåå‘ä»£ç†ï¼‰
5. å¯ç”¨é˜²ç«å¢™è§„åˆ™
6. å®šæœŸå¤‡ä»½

æŸ¥çœ‹[å®Œæ•´è®¾ç½®æŒ‡å—](DOCKER_SETUP.zh.md)äº†è§£ç”Ÿäº§éƒ¨ç½²ã€‚

## æ•°æ®æµ

```
ç”¨æˆ·è¯·æ±‚
    â”‚
    â–¼
å‰ç«¯ï¼ˆæµè§ˆå™¨ï¼‰
    â”‚
    â”œâ”€â–º REST API â”€â”€â”€â”€â”€â”€â–º Rust åç«¯ â”€â”€â”¬â”€â–º PostgreSQL
    â”‚                                â””â”€â–º Redis
    â”‚
    â””â”€â–º WebSocket â”€â”€â”€â”€â”€â–º Socket.IO â”€â”€â”¬â”€â–º Rust åç«¯
                         æ¡¥æ¥         â””â”€â–º Redis
```

## æ•…éšœæ’é™¤

### æœåŠ¡æ— æ³•å¯åŠ¨
```bash
./docker-manage.sh health
docker-compose logs
```

### ç«¯å£å†²çª
```bash
lsof -i :3000
lsof -i :8080
```

### æ•°æ®åº“é—®é¢˜
```bash
./docker-manage.sh shell postgres
docker-compose logs postgres
```

### é‡ç½®æ‰€æœ‰å†…å®¹
```bash
./docker-manage.sh clean  # âš ï¸ åˆ é™¤æ‰€æœ‰æ•°æ®
./docker-manage.sh start
```

## ğŸ“– æ–‡æ¡£ç»“æ„

```
DOCKER_README.zh.md        â† æ‚¨åœ¨è¿™é‡Œï¼ˆæ¦‚è§ˆï¼‰
â”œâ”€â”€ DOCKER_QUICKSTART.zh.md   â† 3åˆ†é’Ÿå¿«é€Ÿå…¥é—¨
â”œâ”€â”€ DOCKER_SETUP.zh.md        â† å®Œæ•´è®¾ç½®æŒ‡å—
â””â”€â”€ DOCKER_DEV.zh.md          â† å¼€å‘å·¥ä½œæµç¨‹
```

## ğŸ› ï¸ æ–‡ä»¶æ¦‚è§ˆ

### é…ç½®
- `docker-compose.yaml` - ç”Ÿäº§æ ˆ
- `docker-compose.dev.yaml` - å¼€å‘æ ˆ
- `env.example` - ç¯å¢ƒå˜é‡æ¨¡æ¿
- `.dockerignore` - Docker æ„å»ºå¿½ç•¥è§„åˆ™

### Dockerfiles
- `Dockerfile` - å‰ç«¯ï¼ˆSvelteKit + Pythonï¼‰
- `rust-backend/Dockerfile` - Rust åç«¯
- `rust-backend/Dockerfile.socketio` - Socket.IO æ¡¥æ¥

### è„šæœ¬
- `docker-manage.sh` - ç®¡ç†è¾…åŠ©è„šæœ¬
- `rust-backend/build.sh` - Rust æ„å»ºè„šæœ¬

### æ–‡æ¡£
- `DOCKER_README.zh.md` - æœ¬æ–‡ä»¶
- `DOCKER_QUICKSTART.zh.md` - å¿«é€Ÿå…¥é—¨
- `DOCKER_SETUP.zh.md` - å®Œæ•´æŒ‡å—
- `DOCKER_DEV.zh.md` - å¼€å‘æŒ‡å—

## ğŸš€ å¼€å§‹ä½¿ç”¨

### æ–°ç”¨æˆ·ï¼ˆåªæƒ³è¿è¡Œå®ƒï¼‰
1. é˜…è¯» [DOCKER_QUICKSTART.zh.md](DOCKER_QUICKSTART.zh.md)
2. è¿è¡Œ `./docker-manage.sh setup`
3. è¿è¡Œ `./docker-manage.sh start`
4. æ‰“å¼€ http://localhost:3000

### å¼€å‘è€…ï¼ˆæ­£åœ¨å¼€å‘ä»£ç ï¼‰
1. é˜…è¯» [DOCKER_DEV.zh.md](DOCKER_DEV.zh.md)
2. å¯åŠ¨åŸºç¡€è®¾æ–½ï¼š`docker-compose -f docker-compose.dev.yaml up -d`
3. æœ¬åœ°è¿è¡Œ Rust åç«¯ï¼š`cd rust-backend && cargo run`
4. æœ¬åœ°è¿è¡Œå‰ç«¯ï¼š`npm run dev`
5. è®¿é—® http://localhost:5173

### ç³»ç»Ÿç®¡ç†å‘˜ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰
1. é˜…è¯» [DOCKER_SETUP.zh.md](DOCKER_SETUP.zh.md)
2. ä½¿ç”¨ç”Ÿäº§å€¼é…ç½® `.env`
3. è®¾ç½®åå‘ä»£ç†ï¼ˆnginx/Traefik/Caddyï¼‰
4. é…ç½® SSL/TLS
5. è®¾ç½®å¤‡ä»½
6. ä½¿ç”¨ `docker-compose up -d` éƒ¨ç½²

## ğŸ’¡ æç¤º

- ä½¿ç”¨ `./docker-manage.sh` æ–¹ä¾¿æ“ä½œ
- ä½¿ç”¨ `./docker-manage.sh logs [service]` æ£€æŸ¥æ—¥å¿—
- ä½¿ç”¨ `./docker-manage.sh backup` å®šæœŸå¤‡ä»½
- ä½¿ç”¨å¼€å‘ compose è¿›è¡Œæœ¬åœ°å¼€å‘
- å¯ç”¨å·¥å…·é…ç½®è¿›è¡Œè°ƒè¯•ï¼š`--profile tools`

## ğŸ†˜ æ”¯æŒ

- **æ—¥å¿—**ï¼š`./docker-manage.sh logs`
- **çŠ¶æ€**ï¼š`./docker-manage.sh status`
- **å¥åº·**ï¼š`./docker-manage.sh health`
- **å¸®åŠ©**ï¼š`./docker-manage.sh help`

è¯¦ç»†ä¿¡æ¯è¯·å‚é˜…å…·ä½“æŒ‡å—ï¼š
- å¿«é€Ÿå…¥é—¨ï¼š`DOCKER_QUICKSTART.zh.md`
- å¼€å‘ï¼š`DOCKER_DEV.zh.md`
- å®Œæ•´æŒ‡å—ï¼š`DOCKER_SETUP.zh.md`

---

**é€‰æ‹©æ‚¨çš„è·¯å¾„ï¼š**
- ğŸš€ æƒ³ç°åœ¨å°±è¿è¡Œï¼Ÿ â†’ [å¿«é€Ÿå…¥é—¨](DOCKER_QUICKSTART.zh.md)
- ğŸ”§ å¼€å‘è€…ï¼Ÿ â†’ [å¼€å‘æŒ‡å—](DOCKER_DEV.zh.md)
- ğŸ“– éœ€è¦è¯¦ç»†ä¿¡æ¯ï¼Ÿ â†’ [å®Œæ•´è®¾ç½®](DOCKER_SETUP.zh.md)

